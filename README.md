![image_2023-10-26_11-12-52](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90269742/6cfdbb2a-7dd9-4b34-a0ec-9955b5e6f296)# Поиск по корпусу
Сайт: https://for0study0projects.pythonanywhere.com

**1. Preprocessing**
   
   Сначала были собраны тексты авторов российских детективов с сайта Lib.ru (http://lib.ru/RUSS_DETEKTIW/) с помощью запросов requests и фунцций get_href, get_text. Так как html разметка текстов на этом сайте не одинаковая для всех текстов, то с помощью split() были взяты только фрагменты самого текста, а также мы сохраняли в отдельные переменные имя автора и название поизведения.
   
   После этого с помощью nltk.tokenize были взяты предложения и слова. Слова проверялись на наличие в них пунктуации так, что знаки препинания не записывались в конечный список слов, а слова размечались с помощью библиотеки pymorphy.

   В итоге, мы получили 123 текстовых файла 'text_i.txt' с записанными в них предложениями и файл 'words.csv' с размеченными словами.

   ![image](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90251910/1bcd36f3-d737-4a22-850b-c3441a2e33c0)
   
   ![image](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90251910/fc15849e-623e-43f6-a792-f7dc90d9fe9b)

**2. Search function**
Функция реализует поиск по корпусу точной формы, леммы, тега или их комбинации. 

После реализации поиска одного токена - расширение возможностей на поиск n токенов из входной строки.

В процессе были проверены возможные ошибки: 
1. Выдача n-граммы, несмотря на то, что один из набора токенов не совпадает с инпутом (находится в префиксе, суффиксе или посередине)
2. Пунктуация в инпуте
3. Дефисное написание
4. Лемматизация частичных омографов

Возникшие при обработке запросов проблемы:
- Недостаток данных (из-за этого сложно проверить проблемные случаи типа дефисного написания)
- Отсутствует разделение слов с дефисом на членимые на леммы и нечленимые. Например, слово "имени-фамилии" состоит из полнозначных склоняемых слов, которые могут употребляться (и имеют полную парадигму) самостоятельно
- Невозможность поиска при помощи регулярных выражений (при помощи префиксов и суффиксов, или, наоборот, делая регулярной серединную часть)
- Нет поиска по семантическим категориям (хотелось бы обучить модель, например, с помощью zero-shot подхода разбивать обучающую выборку на категории)

**3. Website**

Веб-страница, построенная на базе Django, включает в себя:
- окно поиска
![image_2023-10-26_11-08-19](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90269742/d22ac091-4054-4743-8cd5-21a5252dab73)

- модальное окно с краткой информацией о проекте и о том, как составлять запросы (кнопка "помощь")
![image_2023-10-26_11-12-52](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90269742/ea88fcea-b1fe-49ec-8c91-a4dfae295a30)

- зону выдачи результатов: для каждого текста, в котором было зафиксировано совпадение с запросом, создается карточка. На эту карточку выводятся все предложения текста, которые удовлетворяют запросу. Слова, соответствующие запросу, выделяются цветом и жирным курсивным начертанием. Также все найденые словоформы/словосочетания выводятся отдельным блоком справа более крупным шрифтом, чтобы пользователь мог посмотреть на n-граммы отдельно (например, в случае, если ему необходимо определить сочетаемость слова в запросе)
![Uploading image_2023-10-26_11-09-26.png…]()

*Что было сделано:*
1) На основе csv-файлов были созданы модели. Для этого были написаны функции конвертации csv-файлов в модели;
2) Была встроена и адаптирована под Django функция поиска;
3) Была реализована пагинация: результаты запроса (которых может быть достаточно много, например, если мы просто задаем POS-тег) помещаются в кэш-таблицу, эти результаты делятся по страницам и при перелистывании достаются оттуда (так можно избежать повторной отправки запроса —> экономим время) ![image_2023-10-26_11-10-11](https://github.com/s-alyona-a/NLP_3d_course_project/assets/90269742/543da80c-69f8-4718-94fa-11d954e9fe11)

4) Была написана функция для нахождения всех вхождений запроса и их выделений (выделяются желтым цветом, жирным курсивом)
В результате выполнения функции поиска мы получаем список с предложениями и словами/словосочетаниями, которые в этих предложениях были отфильтрованы как подпадающие под данный запрос.

Соответственно, в тексте найденные слова могут встречаться со знаками пунктуации, например:

*'потому что'* - найденная в предложении словоформа

'Я купил кресло *потому, что* оно удобно'  - предложение с вхождением найденной словоформы
Для того чтобы выделить словоформу, надо сперва найти её в предложении, а потом окружить необходимыми html-тегами, при этом сохранив пунктуацию. Для этого были использованы регулярные выражения.

5) Был создан интерфейс сайта с его концепцией и дизайном
6) Сайт был загружен на сервер PythonAnywhere

*Для ускорения работы сайта были предприняты следующие меры:*
1) Сокращение количества обращений к базе данных (путем создания элемента words_objects = Word.objects.all())
2) Создание кэш-таблицы для хранения результатов выполнения запроса
